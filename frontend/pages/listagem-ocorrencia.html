<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Listagem de Ocorrências</title>
  <link rel="stylesheet" href="listagem-ocorrencia-styles.css"/>
</head>
<body>
  <header class="topbar">
    <button class="menu" aria-label="Abrir menu">
      <span></span><span></span><span></span>
    </button>

    <h1>Listagem de Ocorrências</h1>

    <div class="usuario">
      <img src="https://cdn-icons-png.flaticon.com/512/456/456212.png" alt="">
      <span id="usuario-logado">Usuário</span>
    </div>
  </header>

  <main class="layout">
    <!-- Lateral de filtros (somente UI por enquanto) -->
    <aside class="filtros">
      <h3>Filtros</h3>
      <button class="chip">Data</button>
      <button class="chip">Horário</button>
      <button class="chip">Tipo</button>
      <button class="chip">Região</button>
      <button class="chip">Status</button>
    </aside>

    <!-- Lista -->
    <section class="lista">
      <h2 class="titulo-lista">Todas as ocorrências</h2>

      <ul id="lista-ocorrencias" class="ocorrencias">
        <!-- itens renderizados via JS -->
      </ul>
    </section>
  </main>

  <script>
    // guarda/mostra usuário
    const u = localStorage.getItem("usuarioEmail");
    if (u) {
      document.getElementById("usuario-logado").textContent = u;
    } else {
      // se quiser obrigar login, descomente:
      // window.location.href = "login.html";
    }

    // MOCK: exemplos (apenas front). Em produção, isso viria do backend.
    const mock = [
      { titulo: "Bairro São de São José", detalhe: "Próx ao galpão 02 do cais", hora: "14:38", tipo: "Incêndio" },
      { titulo: "Avenida Getúlio Vargas", detalhe: "Em frente à faculdade", hora: "13:12", tipo: "Resgate" },
      { titulo: "Rua do Caririños", detalhe: "Cabo preso a árvore", hora: "10:12", tipo: "Prevenção" },
      { titulo: "Rua Coronel Mares", detalhe: "Mudança houve de rua bombardeios", hora: "14:09 | 21:52", tipo: "Emergência" },
      { titulo: "Avenida Rosa Silva", detalhe: "Incêndio no Sefit", hora: "14:09 | 16:24", tipo: "Incêndio" },
      { titulo: "Conde da Boa Vista", detalhe: "Em frente ao Alicia dos presentes", hora: "09:24", tipo: "Resgate" },
    ];

    // Se o usuário preencheu endereço na tela anterior, adiciona como primeiro item
    const salvo = localStorage.getItem("enderecoOcorrencia");
    if (salvo) {
      const o = JSON.parse(salvo);
      mock.unshift({
        titulo: `${o.endereco || "Endereço"} ${o.numero ? ", " + o.numero : ""}`,
        detalhe: `${o.bairro || ""} ${o.referencia ? " • " + o.referencia : ""}`.trim(),
        hora: new Date().toLocaleTimeString([], {hour: "2-digit", minute: "2-digit"}),
        tipo: "Registro recente"
      });
    }

    // render simples
    const lista = document.getElementById("lista-ocorrencias");
    const iconSvg = `
      <svg width="26" height="26" viewBox="0 0 24 24" fill="white" aria-hidden="true">
        <path d="M13 3s-1 2-3 3c0 0 2-1 3-1 0 0-4 3-4 7a5 5 0 1 0 10 0c0-3-2-5-2-5s.5 2.5-1 4c0 0 .5-2.5-1-5-.5-1-1-2-1-3z"/>
      </svg>`;

    function criaItem({ titulo, detalhe, hora, tipo }) {
      const li = document.createElement("li");
      li.className = "item";

      li.innerHTML = `
        <div class="icone">${iconSvg}</div>
        <div class="texto">
          <div class="linha1">
            <strong class="titulo">${titulo}</strong>
            <span class="hora">${hora}</span>
          </div>
          <div class="linha2">
            <span class="detalhe">${detalhe || ""}</span>
            <span class="badge">${tipo}</span>
          </div>
        </div>
      `;
      return li;
    }

    mock.forEach(o => lista.appendChild(criaItem(o)));
  </script>
</body>
</html>
